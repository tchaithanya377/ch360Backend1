{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %}Student Fees{% endblock %}

{% block extra_css %}
<style>
    .page-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
        border-radius: 0 0 20px 20px;
    }
    
    .page-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin: 0;
    }
    
    .page-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        margin: 0.5rem 0 0 0;
    }
    
    .fee-card {
        border: none;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        overflow: hidden;
        height: 100%;
    }
    
    .fee-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    .fee-card .card-body {
        padding: 1.5rem;
    }
    
    .student-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        margin-right: 1rem;
    }
    
    .status-badge {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }
    
    .amount-display {
        font-size: 1.25rem;
        font-weight: 700;
        margin: 0;
    }
    
    .amount-label {
        font-size: 0.8rem;
        color: #6c757d;
        margin: 0;
    }
    
    .action-buttons {
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .fee-card:hover .action-buttons {
        opacity: 1;
    }
    
    .btn-action {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        transition: all 0.3s ease;
    }
    
    .btn-view {
        background: #28a745;
        color: white;
    }
    
    .btn-view:hover {
        background: #218838;
        transform: scale(1.1);
    }
    
    .btn-edit {
        background: #007bff;
        color: white;
    }
    
    .btn-edit:hover {
        background: #0056b3;
        transform: scale(1.1);
    }
    
    .btn-delete {
        background: #dc3545;
        color: white;
    }
    
    .btn-delete:hover {
        background: #c82333;
        transform: scale(1.1);
    }
    
    .modal-content {
        border: none;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .modal-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px 15px 0 0;
        border: none;
    }
    
    .modal-title {
        font-weight: 600;
    }
    
    .form-control, .form-select {
        border-radius: 10px;
        border: 2px solid #e9ecef;
        padding: 0.75rem 1rem;
        transition: all 0.3s ease;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }
    
    .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 10px;
        padding: 0.75rem 2rem;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    .search-box {
        background: white;
        border-radius: 15px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        padding: 1.5rem;
        margin-bottom: 2rem;
    }
    
    .stats-summary {
        background: white;
        border-radius: 15px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        padding: 1.5rem;
        margin-bottom: 2rem;
    }
    
    .stat-item {
        text-align: center;
        padding: 1rem;
    }
    
    .stat-number {
        font-size: 2rem;
        font-weight: 700;
        color: #667eea;
        margin: 0;
    }
    
    .stat-label {
        font-size: 0.9rem;
        color: #6c757d;
        margin: 0;
    }
    
    .overdue-badge {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }
    
    .paid-badge {
        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }
    
    .partial-badge {
        background: linear-gradient(135deg, #ffc107 0%, #ff8c00 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }
    
    .pending-badge {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col">
                <h1 class="page-title">
                    <i class="fas fa-user-graduate me-3"></i>
                    Student Fees
                </h1>
                <p class="page-subtitle">Manage student fee records and track payment status</p>
            </div>
            <div class="col-auto">
                <button class="btn btn-light btn-lg" data-bs-toggle="modal" data-bs-target="#addStudentFeeModal">
                    <i class="fas fa-plus me-2"></i>Add Student Fee
                </button>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid">
    <!-- Statistics Summary -->
    <div class="stats-summary">
        <div class="row">
            <div class="col-md-3">
                <div class="stat-item">
                    <h3 class="stat-number">{{ student_fees.count }}</h3>
                    <p class="stat-label">Total Student Fees</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-item">
                    <h3 class="stat-number">{{ pending_fees.count }}</h3>
                    <p class="stat-label">Pending Fees</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-item">
                    <h3 class="stat-number">{{ paid_fees.count }}</h3>
                    <p class="stat-label">Paid Fees</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-item">
                    <h3 class="stat-number">{{ overdue_fees.count }}</h3>
                    <p class="stat-label">Overdue Fees</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Search and Filter -->
    <div class="search-box">
        <div class="row align-items-center">
            <div class="col-md-3">
                <div class="input-group">
                    <span class="input-group-text bg-transparent border-end-0">
                        <i class="fas fa-search text-muted"></i>
                    </span>
                    <input type="text" class="form-control border-start-0" id="searchInput" placeholder="Search students...">
                </div>
            </div>
            <div class="col-md-2">
                <select class="form-select" id="statusFilter">
                    <option value="">All Status</option>
                    <option value="PENDING">Pending</option>
                    <option value="PAID">Paid</option>
                    <option value="PARTIAL">Partial</option>
                    <option value="OVERDUE">Overdue</option>
                </select>
            </div>
            <div class="col-md-2">
                <select class="form-select" id="academicYearFilter">
                    <option value="">All Years</option>
                    <option value="2023-2024">2023-2024</option>
                    <option value="2024-2025">2024-2025</option>
                    <option value="2025-2026">2025-2026</option>
                    <option value="2026-2027">2026-2027</option>
                </select>
            </div>
            <div class="col-md-2">
                <select class="form-select" id="gradeFilter">
                    <option value="">All Grades</option>
                    <option value="1">Grade 1</option>
                    <option value="2">Grade 2</option>
                    <option value="3">Grade 3</option>
                    <option value="4">Grade 4</option>
                    <option value="5">Grade 5</option>
                    <option value="6">Grade 6</option>
                    <option value="7">Grade 7</option>
                    <option value="8">Grade 8</option>
                    <option value="9">Grade 9</option>
                    <option value="10">Grade 10</option>
                    <option value="11">Grade 11</option>
                    <option value="12">Grade 12</option>
                </select>
            </div>
            <div class="col-md-3">
                <select class="form-select" id="sortOrder">
                    <option value="student_name">Sort by Student</option>
                    <option value="due_date">Sort by Due Date</option>
                    <option value="amount_due">Sort by Amount</option>
                    <option value="status">Sort by Status</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Student Fees Grid -->
    <div class="row" id="studentFeesGrid">
        {% for student_fee in student_fees %}
        <div class="col-xl-4 col-lg-6 col-md-6 mb-4 fee-item" 
             data-student="{{ student_fee.student.first_name|lower }} {{ student_fee.student.last_name|lower }}" 
             data-status="{{ student_fee.status|lower }}"
             data-year="{{ student_fee.academic_year }}"
             data-grade="{{ student_fee.student.grade_level }}">
            <div class="fee-card card">
                <div class="card-body">
                    <div class="d-flex align-items-start mb-3">
                        <div class="student-avatar">
                            {{ student_fee.student.first_name|first }}{{ student_fee.student.last_name|first }}
                        </div>
                        <div class="flex-grow-1">
                            <h6 class="card-title mb-1">{{ student_fee.student.first_name }} {{ student_fee.student.last_name }}</h6>
                            <small class="text-muted">{{ student_fee.student.roll_number }} - Grade {{ student_fee.student.grade_level }}</small>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-6">
                            <div class="text-center">
                                <h5 class="amount-display text-primary">₹{{ student_fee.amount_due|floatformat:2 }}</h5>
                                <p class="amount-label">Amount Due</p>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="text-center">
                                <h5 class="amount-display text-success">₹{{ student_fee.amount_paid|floatformat:2 }}</h5>
                                <p class="amount-label">Amount Paid</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        {% if student_fee.status == 'PENDING' %}
                            <span class="pending-badge">{{ student_fee.status }}</span>
                        {% elif student_fee.status == 'PAID' %}
                            <span class="paid-badge">{{ student_fee.status }}</span>
                        {% elif student_fee.status == 'PARTIAL' %}
                            <span class="partial-badge">{{ student_fee.status }}</span>
                        {% elif student_fee.status == 'OVERDUE' %}
                            <span class="overdue-badge">{{ student_fee.status }}</span>
                        {% endif %}
                    </div>
                    
                    <div class="d-flex justify-content-center align-items-center mb-3">
                        <small class="text-muted">
                            <i class="fas fa-calendar-alt me-1"></i>
                            Due: {{ student_fee.due_date|date:"M d, Y" }}
                        </small>
                    </div>
                    
                    <div class="d-flex justify-content-center align-items-center mb-2">
                        <small class="text-muted">
                            <i class="fas fa-tag me-1"></i>
                            {{ student_fee.fee_structure_detail.fee_category.name }}
                        </small>
                    </div>
                    
                    <div class="action-buttons d-flex justify-content-center gap-2">
                        <button class="btn-action btn-view" 
                                onclick="window.location.href='{% url 'dashboard:fees_student_fee_detail' student_fee.id %}'">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-action btn-edit" 
                                onclick="editStudentFee('{{ student_fee.id }}', '{{ student_fee.student.id }}', '{{ student_fee.fee_structure_detail.id }}', '{{ student_fee.academic_year }}', '{{ student_fee.amount_due }}', '{{ student_fee.amount_paid }}', '{{ student_fee.due_date|date:"Y-m-d" }}', '{{ student_fee.status }}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-action btn-delete" 
                                onclick="deleteStudentFee('{{ student_fee.id }}', '{{ student_fee.student.first_name }} {{ student_fee.student.last_name }}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="text-center py-5">
                <i class="fas fa-user-graduate fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No student fees found</h4>
                <p class="text-muted">Create your first student fee record to get started</p>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addStudentFeeModal">
                    <i class="fas fa-plus me-2"></i>Add Student Fee
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Add Student Fee Modal -->
<div class="modal fade" id="addStudentFeeModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-plus me-2"></i>Add New Student Fee
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <form method="post" action="{% url 'dashboard:fees_student_fees_list' %}">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="student" class="form-label">Student *</label>
                                <select class="form-select" id="student" name="student" required>
                                    <option value="">Select Student</option>
                                    {% for student in students %}
                                    <option value="{{ student.id }}">{{ student.first_name }} {{ student.last_name }} ({{ student.roll_number }})</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="fee_structure_detail" class="form-label">Fee Structure Detail *</label>
                                <select class="form-select" id="fee_structure_detail" name="fee_structure_detail" required>
                                    <option value="">Select Fee Structure Detail</option>
                                    {% for detail in fee_structure_details %}
                                    <option value="{{ detail.id }}">{{ detail.fee_category.name }} - ₹{{ detail.amount }} ({{ detail.fee_structure.name }})</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="academic_year" class="form-label">Academic Year *</label>
                                <select class="form-select" id="academic_year" name="academic_year" required>
                                    <option value="">Select Academic Year</option>
                                    <option value="2023-2024">2023-2024</option>
                                    <option value="2024-2025">2024-2025</option>
                                    <option value="2025-2026">2025-2026</option>
                                    <option value="2026-2027">2026-2027</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="due_date" class="form-label">Due Date *</label>
                                <input type="date" class="form-control" id="due_date" name="due_date" required>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="amount_due" class="form-label">Amount Due *</label>
                                <input type="number" class="form-control" id="amount_due" name="amount_due" step="0.01" min="0" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="amount_paid" class="form-label">Amount Paid</label>
                                <input type="number" class="form-control" id="amount_paid" name="amount_paid" step="0.01" min="0" value="0">
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="status" class="form-label">Status</label>
                        <select class="form-select" id="status" name="status">
                            <option value="PENDING">Pending</option>
                            <option value="PAID">Paid</option>
                            <option value="PARTIAL">Partial</option>
                            <option value="OVERDUE">Overdue</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Save Student Fee
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Student Fee Modal -->
<div class="modal fade" id="editStudentFeeModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-edit me-2"></i>Edit Student Fee
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <form method="post" action="{% url 'dashboard:fees_student_fees_list' %}">
                {% csrf_token %}
                <input type="hidden" id="edit_student_fee_id" name="student_fee_id">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit_student" class="form-label">Student *</label>
                                <select class="form-select" id="edit_student" name="student" required>
                                    {% for student in students %}
                                    <option value="{{ student.id }}">{{ student.first_name }} {{ student.last_name }} ({{ student.roll_number }})</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit_fee_structure_detail" class="form-label">Fee Structure Detail *</label>
                                <select class="form-select" id="edit_fee_structure_detail" name="fee_structure_detail" required>
                                    {% for detail in fee_structure_details %}
                                    <option value="{{ detail.id }}">{{ detail.fee_category.name }} - ₹{{ detail.amount }} ({{ detail.fee_structure.name }})</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit_academic_year" class="form-label">Academic Year *</label>
                                <select class="form-select" id="edit_academic_year" name="academic_year" required>
                                    <option value="2023-2024">2023-2024</option>
                                    <option value="2024-2025">2024-2025</option>
                                    <option value="2025-2026">2025-2026</option>
                                    <option value="2026-2027">2026-2027</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit_due_date" class="form-label">Due Date *</label>
                                <input type="date" class="form-control" id="edit_due_date" name="due_date" required>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit_amount_due" class="form-label">Amount Due *</label>
                                <input type="number" class="form-control" id="edit_amount_due" name="amount_due" step="0.01" min="0" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit_amount_paid" class="form-label">Amount Paid</label>
                                <input type="number" class="form-control" id="edit_amount_paid" name="amount_paid" step="0.01" min="0">
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="edit_status" class="form-label">Status</label>
                        <select class="form-select" id="edit_status" name="status">
                            <option value="PENDING">Pending</option>
                            <option value="PAID">Paid</option>
                            <option value="PARTIAL">Partial</option>
                            <option value="OVERDUE">Overdue</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Update Student Fee
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteStudentFeeModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger">
                <h5 class="modal-title">
                    <i class="fas fa-exclamation-triangle me-2"></i>Delete Student Fee
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete the student fee for "<strong id="deleteStudentFeeName"></strong>"?</p>
                <p class="text-danger mb-0">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    This action cannot be undone and will affect all related payments and records.
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form method="post" action="{% url 'dashboard:fees_student_fees_list' %}" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" id="delete_student_fee_id" name="delete_student_fee_id">
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-trash me-2"></i>Delete Student Fee
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Search and filter functionality
document.getElementById('searchInput').addEventListener('input', filterStudentFees);
document.getElementById('statusFilter').addEventListener('change', filterStudentFees);
document.getElementById('academicYearFilter').addEventListener('change', filterStudentFees);
document.getElementById('gradeFilter').addEventListener('change', filterStudentFees);
document.getElementById('sortOrder').addEventListener('change', filterStudentFees);

function filterStudentFees() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const statusFilter = document.getElementById('statusFilter').value;
    const yearFilter = document.getElementById('academicYearFilter').value;
    const gradeFilter = document.getElementById('gradeFilter').value;
    const sortOrder = document.getElementById('sortOrder').value;
    
    const fees = document.querySelectorAll('.fee-item');
    const feesArray = Array.from(fees);
    
    // Filter fees
    feesArray.forEach(fee => {
        const student = fee.dataset.student;
        const status = fee.dataset.status;
        const year = fee.dataset.year;
        const grade = fee.dataset.grade;
        
        const matchesSearch = student.includes(searchTerm);
        const matchesStatus = !statusFilter || status === statusFilter.toLowerCase();
        const matchesYear = !yearFilter || year === yearFilter;
        const matchesGrade = !gradeFilter || grade === gradeFilter;
        
        if (matchesSearch && matchesStatus && matchesYear && matchesGrade) {
            fee.style.display = 'block';
        } else {
            fee.style.display = 'none';
        }
    });
    
    // Sort fees
    feesArray.sort((a, b) => {
        if (sortOrder === 'student_name') {
            return a.dataset.student.localeCompare(b.dataset.student);
        } else if (sortOrder === 'due_date') {
            // Sort by due date (you might need to add this data attribute)
            return 0;
        } else if (sortOrder === 'amount_due') {
            // Sort by amount (you might need to add this data attribute)
            return 0;
        } else if (sortOrder === 'status') {
            return a.dataset.status.localeCompare(b.dataset.status);
        }
        return 0;
    });
    
    // Reorder in DOM
    const grid = document.getElementById('studentFeesGrid');
    feesArray.forEach(fee => {
        if (fee.style.display !== 'none') {
            grid.appendChild(fee);
        }
    });
}

// Edit student fee function
function editStudentFee(id, studentId, feeStructureDetailId, academicYear, amountDue, amountPaid, dueDate, status) {
    document.getElementById('edit_student_fee_id').value = id;
    document.getElementById('edit_student').value = studentId;
    document.getElementById('edit_fee_structure_detail').value = feeStructureDetailId;
    document.getElementById('edit_academic_year').value = academicYear;
    document.getElementById('edit_amount_due').value = amountDue;
    document.getElementById('edit_amount_paid').value = amountPaid;
    document.getElementById('edit_due_date').value = dueDate;
    document.getElementById('edit_status').value = status;
    
    new bootstrap.Modal(document.getElementById('editStudentFeeModal')).show();
}

// Delete student fee function
function deleteStudentFee(id, name) {
    document.getElementById('delete_student_fee_id').value = id;
    document.getElementById('deleteStudentFeeName').textContent = name;
    
    new bootstrap.Modal(document.getElementById('deleteStudentFeeModal')).show();
}

// Success message handling
{% if messages %}
    {% for message in messages %}
        {% if message.tags == 'success' %}
            // Show success toast or alert
            setTimeout(function() {
                const toast = new bootstrap.Toast(document.createElement('div'));
                toast.show();
            }, 100);
        {% endif %}
    {% endfor %}
{% endif %}
</script>
{% endblock %}
